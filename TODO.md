
Инициализацияю в main в отдельную функцию.

Почему решатель сделан в main, а не в солвере.

Убрать все двумерные массивы и двумерную индексацию.

Структура сетки

Mesh {

число ячеек;
массив центров ячеек;
массив объемов ячеек;

далее разные массивы под данные граней (каждый в 4 раза больше массива ячеек)

индексы соседей
площадь грани
внешняя нормаль грани

}

Всё это должно инициализироваться в конструкторе Mesh

Решатель - метод конечных объемов для неструктурированных сеток

float_t flux = 0.0;
сумма потоков по граням...
T_next[i] = T_prev[i] + dt * flux / volume[i];